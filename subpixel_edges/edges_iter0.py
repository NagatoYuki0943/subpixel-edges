import numpy as np
from numba import njit


@njit(cache=True)
def h_edges(
    image_flatten: np.ndarray,  # 展平的原始图像, ravel("F") 展平的图像     [900]
    Gx: np.ndarray,  # 图像在x方向上的梯度分量                              [900]
    Gy: np.ndarray,  # 图像在y方向上的梯度分量                              [900]
    x: np.ndarray,  # 图像在 x 方向上的索引                                [900]
    y: np.ndarray,  # 图像在 y 方向上的索引                                [900]
    edges: np.ndarray,  # 一维数组, 包含检测到的边缘点的索引                  [27]
    rows: int,  # 图像的行数                                              30
    order: int,  # 指定多项式的阶数, 用于拟合边缘
):
    n_edges = edges.shape[0]  # 27

    A = np.zeros(n_edges)  # [27]
    B = np.zeros(n_edges)  # [27]
    a = np.zeros(n_edges)  # [27]
    b = np.zeros(n_edges)  # [27]
    c = np.zeros(n_edges)  # [27]

    for k in range(n_edges):
        edge = edges[k]  # 247

        # m: 这个参数是一个符号变量, 用于指示边缘的梯度方向
        #   如果 Gx[edge] * Gy[edge] >= 0 表示 Gx 和 Gy 同号, m 被设为 1; 如果异号, m 被设为 -1.

        # compute window floating limits
        # m1, m2, l1, l2, r1, r2 在 5.1 章
        # m1, m2, min_m1, max_m2: 这些参数定义了在边缘点垂直方向（沿着边缘方向）搜索的边界
        #   m1 和 m2 是沿边缘方向的起始点和结束点. 它们用于找到垂直于边缘的最强梯度变化
        #   min_m1 是 m1 的最小值限制
        #   max_m2 是 m2 的最大值限制

        # l1, l2, min_l1, max_l2: 这些参数定义了在边缘点左侧（沿着边缘方向）搜索的边界
        #   l1 和 l2 是沿边缘方向的起始点和结束点. 它们用于找到垂直于边缘的最强梯度变化
        #   min_l1 是 l1 的最小值限制
        #   max_l2 是 l2 的最大值限制

        # r1, r2, min_r1, max_r2: 这些参数定义了在边缘点右侧（沿着边缘方向）搜索的边界
        #   r1 和 r2 是沿边缘方向的起始点和结束点. 它们用于找到垂直于边缘的最强梯度变化
        #   min_r1 是 r1 的最小值限制
        #   max_r2 是 r2 的最大值限制
        m1 = -1
        m2 = 1
        min_m1 = -4
        max_m2 = 4
        # 根据 Gx 和 Gy 的乘积（表示梯度的方向）调整边界变量, 乘积是否大于0代表直线的方向
        # ↖️⬆️↗️  上下左右方向代表 Gx Gy,假设 Gx >= 0 为朝右, Gy >= 0 朝上
        # ⬅️  ➡️  则右上方向和左下方向代表斜率 >= 0, Gx * Gy >= 0
        # ↙️⬇️↘️  则左上方向和右下方向代表斜率 < 0, Gx * Gy < 0
        # 下面 2 种方式是 l 和 r 左右颠倒
        if Gx[edge] * Gy[edge] >= 0:
            m = 1

            l1 = 0
            l2 = 1
            min_l1 = -3
            max_l2 = 4

            r1 = -1
            r2 = 0
            min_r1 = -4
            max_r2 = 3
        else:
            m = -1

            l1 = -1
            l2 = 0
            min_l1 = -4
            max_l2 = 3

            r1 = 0
            r2 = 1
            min_r1 = -3
            max_r2 = 4

        # 如果 Gx 的绝对值小于 1, 则调整边界, 使其更加紧凑
        if np.abs(Gx[edge]) < 1:
            l1 = -1
            l2 = 1
            r1 = -1
            r2 = 1

        # 通过 while 循环确定边界索引 l1, l2, m1, m2, r1 和 r2, 这些索引定义了用于计算边缘点系数的像素范围
        # 找范围内的梯度最小值
        while l1 > min_l1 and np.abs(Gy[edge - rows + l1]) >= np.abs(
            Gy[edge - rows + l1 - 1]
        ):
            l1 -= 1

        while l2 < max_l2 and np.abs(Gy[edge - rows + l2]) >= np.abs(
            Gy[edge - rows + l2 + 1]
        ):
            l2 += 1

        while m1 > min_m1 and np.abs(Gy[edge + m1]) >= np.abs(Gy[edge + m1 - 1]):
            m1 -= 1

        while m2 < max_m2 and np.abs(Gy[edge + m2]) >= np.abs(Gy[edge + m2 + 1]):
            m2 += 1

        while r1 > min_r1 and np.abs(Gy[edge + rows + r1]) >= np.abs(
            Gy[edge + rows + r1 - 1]
        ):
            r1 -= 1

        while r2 < max_r2 and np.abs(Gy[edge + rows + r2]) >= np.abs(
            Gy[edge + rows + r2 + 1]
        ):
            r2 += 1

        # 根据 m 的符号计算 AA 和 BB
        if m > 0:
            # (下侧 + 右边一列的下侧) / 2 **
            # (上侧 + 左边一列的上侧) / 2  **
            AA = (image_flatten[edge + m2] + image_flatten[edge + rows + r2]) / 2
            BB = (image_flatten[edge + m1] + image_flatten[edge - rows + l1]) / 2
        else:
            # (下侧 + 左边一列的下侧) / 2  **
            # (上侧 + 右边一列的上侧) / 2 **
            AA = (image_flatten[edge + m2] + image_flatten[edge - rows + l2]) / 2
            BB = (image_flatten[edge + m1] + image_flatten[edge + rows + r1]) / 2

        SL = 0
        SM = 0
        SR = 0

        # 累加像素值,强度求和
        # 左侧
        for n in range(l1, l2 + 1):
            SL += image_flatten[edge - rows + n]
        # 中间
        for n in range(m1, m2 + 1):
            SM += image_flatten[edge + n]
        # 右侧
        for n in range(r1, r2 + 1):
            SR += image_flatten[edge + rows + n]

        # 分母
        den = 2 * (AA - BB)

        # 根据 order 和分母 den 的值计算多项式系数 c, b 和 a
        #  y = a + b * x + c * x^2
        # 公式多的部分在 5.1 章
        if order == 2:
            # 二阶多项式
            if den != 0:
                c[k] = (
                    SL + SR - 2 * SM + AA * (2 * m2 - l2 - r2) - BB * (2 * m1 - l1 - r1)
                ) / den
        else:
            # 一阶多项式
            c[k] = 0

        if den != 0:
            b[k] = (SR - SL + AA * (l2 - r2) - BB * (l1 - r1)) / den
            # a 和位置偏移有关
            a[k] = (2 * SM - AA * (1 + 2 * m2) - BB * (1 - 2 * m1)) / den - c[k] / 12

        # 计算得到的 A B 存储到 A 和 B 数组中
        A[k] = AA
        B[k] = BB

    # 像素边缘坐标
    pixel_x = x[edges]
    pixel_y = y[edges]

    # 亚像素边缘坐标, x 方向为像素坐标, y 方向为亚像素坐标
    x = x[edges]
    y = y[edges] - a

    # nx 和 ny
    # 含义：这两个数组组成了一个单位法向量，即在边缘处的“法向”（或称垂直方向）。
    # 计算过程：
    #     – 程序先通过比较边缘两侧的平均强度（A 与 B）确定边缘方向的“极性”，用 np.sign(A-B) 得到正负信息。
    #     – 同时，利用参数 b（拟合多项式 y = a + b*x 得到的一阶项，即局部斜率）计算了归一化因子 1/√(1+b²) 。
    #     – 最终，nx 按公式 nx = np.sign(A-B)·b/√(1+b²) 得到，而 ny = np.sign(A-B)/√(1+b²) 。
    # 几何意义：
    #     – 如果设拟合曲线的局部斜率为 tanθ，则 ny 对应 cosθ 而 nx 对应 sinθ（外加一个与边缘强度变化方向有关的符号）。
    #     – 这样得到 (nx, ny) 就是指向边缘“正面”（通常由暗侧指向亮侧）的单位法向量，可用于后续的边缘精细定位或形状分析。
    nx = np.sign(A - B) / np.sqrt(1 + b**2) * b
    ny = np.sign(A - B) / np.sqrt(1 + b**2)

    # curv (边缘曲率)
    # 含义：curv 表示边缘在亚像素层面处的曲率，即描述边缘弯曲程度和方向的一个量。
    # 计算过程：
    #     – 在拟合局部灰度变化时，若 order==2，则通过二阶多项式拟合 (即 y = a + b·x + c·x²) 得到二阶系数 c。
    #     – 标准二阶曲线的曲率公式为 2·c/(1+b²)^(3/2) ，这里程序中又乘上了 nn ，nn 根据 Gy 的正负（梯度 y 分量）调整符号，使得曲率的正负方向与梯度方向相一致。
    # 几何意义：
    #     – curv 的数值表示边缘局部弯曲的程度：绝对值越大说明弯曲越明显；正负则指示边缘向哪一侧弯曲。
    #     – 若 order 为 1（二阶项为 0），则 curv 归零，表明边缘局部近似直线。
    nn = np.ones(edges.shape[0])
    nn[Gy[edges] < 0] = -1  # 梯度方向相反
    curv = 2 * c * nn / ((1 + b**2) ** 1.5)

    # i0 和 i1
    # 含义：这两个值描述边缘两侧的平均灰度值。
    # 计算过程：
    #     – A 与 B 分别是通过在边缘点两侧（由 m1, m2, l1, l2, r1, r2 所限定的像素区域）对图像像素灰度进行加权或平均得到的。
    #     – 为了区分边缘的暗侧和亮侧，通过 np.minimum(A, B) 得到 i0（较暗的一侧），而 np.maximum(A, B) 得到 i1（较亮的一侧）。
    # 意义与应用：
    #     – i0 和 i1 为后续边缘分析（例如边缘分类、阈值选择或进一步精细定位）提供了边缘两侧的灰度信息。
    #     – 边缘由灰度的突变引起，i0 与 i1 的差异往往决定了边缘的对比度及检测的鲁棒性。
    i0 = np.minimum(A, B)
    i1 = np.maximum(A, B)

    # pixel_x, pixel_y, x, y, nx, ny, curv, i0, i1 all shape: [27]
    return pixel_x, pixel_y, x, y, nx, ny, curv, i0, i1


@njit(cache=True)
def v_edges(
    image_flatten: np.ndarray,  # 展平的原始图像, ravel("F") 展平的图像     [900]
    Gx: np.ndarray,  # 图像在x方向上的梯度分量                              [900]
    Gy: np.ndarray,  # 图像在y方向上的梯度分量                              [900]
    x: np.ndarray,  # 图像在 x 方向上的索引                                [900]
    y: np.ndarray,  # 图像在 y 方向上的索引                                [900]
    edges: np.ndarray,  # 一维数组, 包含检测到的边缘点的索引                  [28]
    rows: int,  # 图像的行数                                              30
    order: int,  # 指定多项式的阶数, 用于拟合边缘
):
    n_edges = edges.shape[0]  # 28

    A = np.zeros(n_edges)  # [28]
    B = np.zeros(n_edges)  # [28]
    a = np.zeros(n_edges)  # [28]
    b = np.zeros(n_edges)  # [28]
    c = np.zeros(n_edges)  # [28]

    for k in range(n_edges):
        edge = edges[k]

        # m: 这个参数是一个符号变量, 用于指示边缘的梯度方向
        #   如果 Gx[edge] * Gy[edge] >= 0 表示 Gx 和 Gy 同号, m 被设为 1; 如果异号, m 被设为 -1.

        # compute window floating limits
        # m1, m2, l1, l2, r1, r2 在 5.1 章
        # m1, m2, min_m1, max_m2: 这些参数定义了在边缘点水平方向（沿着边缘方向）搜索的边界
        #   m1 和 m2 是沿边缘方向的起始点和结束点. 它们用于找到水平于边缘的最强梯度变化
        #   min_m1 是 m1 的最小值限制
        #   max_m2 是 m2 的最大值限制

        # l1, l2, min_l1, max_l2: 这些参数定义了在边缘点上侧（沿着边缘方向）搜索的边界
        #   l1 和 l2 是沿边缘方向的起始点和结束点. 它们用于找到垂直于边缘的最强梯度变化
        #   min_l1 是 l1 的最小值限制
        #   max_l2 是 l2 的最大值限制

        # r1, r2, min_r1, max_r2: 这些参数定义了在边缘点下侧（沿着边缘方向）搜索的边界
        #   r1 和 r2 是沿边缘方向的起始点和结束点. 它们用于找到垂直于边缘的最强梯度变化
        #   min_r1 是 r1 的最小值限制
        #   max_r2 是 r2 的最大值限制
        m1 = -1
        m2 = 1
        min_m1 = -4
        max_m2 = 4
        # 根据 Gx 和 Gy 的乘积（表示梯度的方向）调整边界变量, 乘积是否大于0代表直线的方向
        # ↖️⬆️↗️  上下左右方向代表 Gx Gy,假设 Gx >= 0 为朝右, Gy >= 0 朝上
        # ⬅️  ➡️  则右上方向和左下方向代表斜率 >= 0, Gx * Gy >= 0
        # ↙️⬇️↘️  则左上方向和右下方向代表斜率 < 0, Gx * Gy < 0
        # 下面 2 种方式是 l 和 r 左右颠倒
        if Gx[edge] * Gy[edge] >= 0:
            m = 1

            l1 = 0
            l2 = 1
            min_l1 = -3
            max_l2 = 4

            r1 = -1
            r2 = 0
            min_r1 = -4
            max_r2 = 3
        else:
            m = -1

            l1 = -1
            l2 = 0
            min_l1 = -4
            max_l2 = 3

            r1 = 0
            r2 = 1
            min_r1 = -3
            max_r2 = 4

        # 如果 Gy 的绝对值小于 1, 则调整边界, 使其更加紧凑
        if np.abs(Gy[edge]) < 1:
            l1 = -1
            l2 = 1
            r1 = -1
            r2 = 1

        # 通过 while 循环确定边界索引 l1, l2, m1, m2, r1 和 r2, 这些索引定义了用于计算边缘点系数的像素范围
        # 找范围内的梯度最小值
        while l1 > min_l1 and np.abs(Gx[edge + l1 * rows - 1]) >= np.abs(
            Gx[edge + (l1 - 1) * rows - 1]
        ):
            l1 -= 1

        while l2 < max_l2 and np.abs(Gx[edge + l2 * rows - 1]) >= np.abs(
            Gx[edge + (l2 + 1) * rows - 1]
        ):
            l2 += 1

        while m1 > min_m1 and np.abs(Gx[edge + m1 * rows]) >= np.abs(
            Gx[edge + (m1 - 1) * rows]
        ):
            m1 -= 1

        while m2 < max_m2 and np.abs(Gx[edge + m2 * rows]) >= np.abs(
            Gx[edge + (m2 + 1) * rows]
        ):
            m2 += 1

        while r1 > min_r1 and np.abs(Gx[edge + r1 * rows + 1]) >= np.abs(
            Gx[edge + (r1 - 1) * rows + 1]
        ):
            r1 -= 1

        while r2 < max_r2 and np.abs(Gx[edge + r2 * rows + 1]) >= np.abs(
            Gx[edge + (r2 + 1) * rows + 1]
        ):
            r2 += 1

        # 根据 m 的符号计算 AA 和 BB
        if m > 0:
            # (右侧 + 下边一行的右侧) / 2 **
            # (左侧 + 上边一行的左侧) / 2  **
            AA = (
                image_flatten[edge + m2 * rows] + image_flatten[edge + r2 * rows + 1]
            ) / 2
            BB = (
                image_flatten[edge + m1 * rows] + image_flatten[edge + l1 * rows - 1]
            ) / 2
        else:
            # (右侧 + 上边一行的右侧) / 2  **
            # (左侧 + 下边一行的左侧) / 2 **
            AA = (
                image_flatten[edge + m2 * rows] + image_flatten[edge + l2 * rows - 1]
            ) / 2
            BB = (
                image_flatten[edge + m1 * rows] + image_flatten[edge + r1 * rows + 1]
            ) / 2

        SL = 0
        SM = 0
        SR = 0

        # 累加像素值,强度求和
        # 上侧
        for n in range(l1, l2 + 1):
            SL += image_flatten[edge + n * rows - 1]
        # 中间
        for n in range(m1, m2 + 1):
            SM += image_flatten[edge + n * rows]
        # 下侧
        for n in range(r1, r2 + 1):
            SR += image_flatten[edge + n * rows + 1]

        # 分母
        den = 2 * (AA - BB)

        # 根据 order 和分母 den 的值计算多项式系数 c, b 和 a
        #  x = a + b * y + c * y^2
        # 公式多的部分在 5.1 章
        if order == 2:
            # 二阶多项式
            if den != 0:
                c[k] = (
                    SL + SR - 2 * SM + AA * (2 * m2 - l2 - r2) - BB * (2 * m1 - l1 - r1)
                ) / den
        else:
            # 一阶多项式
            c[k] = 0

        if den != 0:
            b[k] = (SR - SL + AA * (l2 - r2) - BB * (l1 - r1)) / den
            # a 和位置偏移有关
            a[k] = (2 * SM - AA * (1 + 2 * m2) - BB * (1 - 2 * m1)) / den - c[k] / 12

        # 计算得到的 A B 存储到 A 和 B 数组中
        A[k] = AA
        B[k] = BB

    # 像素边缘坐标
    pixel_x = x[edges]
    pixel_y = y[edges]

    # 亚像素边缘坐标, x 方向为亚像素坐标, y 方向为像素坐标
    x = x[edges] - a
    y = y[edges]

    # nx 和 ny
    # 含义：这两个数组组成了一个单位法向量，即在边缘处的“法向”（或称垂直方向）。
    # 计算过程：
    #     – 程序先通过比较边缘两侧的平均强度（A 与 B）确定边缘方向的“极性”，用 np.sign(A-B) 得到正负信息。
    #     – 同时，利用参数 b（拟合多项式 y = a + b*x 得到的一阶项，即局部斜率）计算了归一化因子 1/√(1+b²) 。
    #     – 最终，nx 按公式 nx = np.sign(A-B)·b/√(1+b²) 得到，而 ny = np.sign(A-B)/√(1+b²) 。
    # 几何意义：
    #     – 如果设拟合曲线的局部斜率为 tanθ，则 ny 对应 cosθ 而 nx 对应 sinθ（外加一个与边缘强度变化方向有关的符号）。
    #     – 这样得到 (nx, ny) 就是指向边缘“正面”（通常由暗侧指向亮侧）的单位法向量，可用于后续的边缘精细定位或形状分析。
    nx = np.sign(A - B) / np.sqrt(1 + b**2)
    ny = np.sign(A - B) / np.sqrt(1 + b**2) * b

    # curv (边缘曲率)
    # 含义：curv 表示边缘在亚像素层面处的曲率，即描述边缘弯曲程度和方向的一个量。
    # 计算过程：
    #     – 在拟合局部灰度变化时，若 order==2，则通过二阶多项式拟合 (即 y = a + b·x + c·x²) 得到二阶系数 c。
    #     – 标准二阶曲线的曲率公式为 2·c/(1+b²)^(3/2) ，这里程序中又乘上了 nn ，nn 根据 Gy 的正负（梯度 y 分量）调整符号，使得曲率的正负方向与梯度方向相一致。
    # 几何意义：
    #     – curv 的数值表示边缘局部弯曲的程度：绝对值越大说明弯曲越明显；正负则指示边缘向哪一侧弯曲。
    #     – 若 order 为 1（二阶项为 0），则 curv 归零，表明边缘局部近似直线。
    nn = np.ones(edges.shape[0])
    nn[Gx[edges] < 0] = -1  # 梯度方向相反
    curv = 2 * c * nn / ((1 + b**2) ** 1.5)

    # i0 和 i1
    # 含义：这两个值描述边缘两侧的平均灰度值。
    # 计算过程：
    #     – A 与 B 分别是通过在边缘点两侧（由 m1, m2, l1, l2, r1, r2 所限定的像素区域）对图像像素灰度进行加权或平均得到的。
    #     – 为了区分边缘的暗侧和亮侧，通过 np.minimum(A, B) 得到 i0（较暗的一侧），而 np.maximum(A, B) 得到 i1（较亮的一侧）。
    # 意义与应用：
    #     – i0 和 i1 为后续边缘分析（例如边缘分类、阈值选择或进一步精细定位）提供了边缘两侧的灰度信息。
    #     – 边缘由灰度的突变引起，i0 与 i1 的差异往往决定了边缘的对比度及检测的鲁棒性。
    i0 = np.minimum(A, B)
    i1 = np.maximum(A, B)

    # pixel_x, pixel_y, x, y, nx, ny, curv, i0, i1 all shape: [28]
    return pixel_x, pixel_y, x, y, nx, ny, curv, i0, i1


def test_h_v_edges():
    image_flatten = np.array([255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 253.0, 240.0, 249.0, 222.0, 165.0, 165.0, 222.0, 249.0, 240.0, 253.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 243.0, 212.0, 62.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 62.0, 212.0, 243.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 253.0, 245.0, 124.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 124.0, 245.0, 253.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 245.0, 53.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 54.0, 245.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 243.0, 123.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 124.0, 243.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 253.0, 212.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 213.0, 253.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 240.0, 62.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 62.0, 240.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 249.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 250.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 221.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 223.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 164.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 167.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 167.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 222.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 223.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 249.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 250.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 240.0, 62.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 62.0, 240.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 253.0, 213.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 213.0, 253.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 243.0, 124.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 125.0, 243.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 245.0, 54.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 54.0, 244.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 253.0, 245.0, 125.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 125.0, 245.0, 253.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 243.0, 213.0, 62.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 62.0, 213.0, 243.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 253.0, 240.0, 250.0, 223.0, 167.0, 167.0, 223.0, 250.0, 240.0, 253.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0, 255.0])
    Gx = np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -7.5, -3.0, -16.5, -45.0, -45.0, -16.5, -3.0, -7.5, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -21.5, -96.5, -123.0, -127.5, -127.5, -127.5, -127.5, -123.0, -96.5, -21.5, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -5.0, -65.5, -124.5, -120.0, -124.5, -111.0, -82.5, -82.5, -111.0, -124.5, -120.0, -124.5, -65.5, -5.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, -101.0, -121.5, -106.0, -31.0, -4.5, 0.0, 0.0, 0.0, 0.0, -4.5, -31.0, -106.0, -121.5, -100.5, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -65.0, -122.5, -62.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, -62.0, -122.5, -64.5, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -21.5, -120.5, -26.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -27.0, -120.5, -21.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -7.5, -90.5, -61.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -62.0, -90.5, -7.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, -101.5, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, -102.0, -1.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -9.5, -31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -31.0, -8.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -42.5, -4.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.5, -41.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 42.0, 4.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 41.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 31.0, 8.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 102.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 101.5, 1.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.5, 90.5, 62.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 62.5, 90.5, 7.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 21.0, 120.5, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 120.0, 21.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 64.5, 122.5, 62.5, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 62.5, 122.5, 64.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 100.5, 121.5, 106.5, 31.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 31.0, 106.5, 121.5, 100.5, 5.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 65.0, 124.5, 120.0, 125.0, 111.5, 83.5, 83.5, 111.5, 125.0, 120.0, 124.5, 65.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 21.0, 96.5, 122.5, 127.5, 127.5, 127.5, 127.5, 122.5, 96.5, 21.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 7.5, 2.5, 16.0, 44.0, 44.0, 16.0, 2.5, 7.5, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])
    Gy = np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -7.5, -2.0, -9.0, -42.0, -28.5, 28.5, 42.0, 9.0, 2.0, 7.5, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -21.5, -90.5, -101.5, -31.0, -4.5, 0.0, 0.0, 4.5, 31.0, 101.5, 90.5, 21.5, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -5.0, -64.5, -120.5, -62.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 62.0, 120.5, 64.5, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, -101.0, -122.5, -26.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 122.5, 100.5, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -66.0, -121.5, -61.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 62.0, 121.5, 65.5, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -21.5, -124.5, -106.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 106.5, 124.5, 21.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -7.5, -96.5, -120.0, -31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 31.0, 120.0, 96.5, 7.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -3.0, -123.0, -124.5, -4.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.5, 125.0, 123.0, 2.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, -127.5, -110.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 111.5, 127.5, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -45.5, -127.5, -82.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 83.5, 127.5, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -45.0, -127.5, -82.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 83.5, 127.5, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.5, -127.5, -111.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 111.5, 127.5, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -3.0, -123.0, -124.5, -4.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 125.0, 122.5, 2.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -7.5, -96.5, -120.0, -31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 31.0, 120.0, 96.5, 7.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -21.0, -124.5, -106.5, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 106.5, 124.5, 21.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -65.5, -121.5, -62.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 62.5, 121.5, 65.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, -100.5, -122.5, -27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 122.0, 100.5, 5.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -5.0, -64.0, -120.5, -62.5, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 62.5, 120.5, 64.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -21.0, -90.5, -101.5, -31.0, -5.0, 0.0, 0.0, 5.0, 31.0, 101.5, 90.5, 21.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, -7.5, -1.5, -8.5, -41.5, -28.0, 28.0, 41.5, 8.5, 1.5, 7.5, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])
    x = np.array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29])
    y = np.array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29])
    h_edges_ = np.array([248, 261, 277, 292, 306, 323, 336, 353, 366, 383, 395, 414, 425, 444, 455, 474, 485, 504, 516, 533, 546, 563, 576, 593, 607, 622, 638])
    v_edges_ = np.array([163, 164, 165, 166, 190, 191, 192, 197, 198, 199, 219, 230, 248, 261, 638, 651, 669, 680, 700, 701, 702, 707, 708, 709, 733, 734, 735, 736])
    rows = 30
    order = 2

    print("test_h_edges start")
    pixel_x, pixel_y, subpixel_x, subpixel_y, nx, ny, curv, i0, i1 = h_edges(
        image_flatten,
        Gx,
        Gy,
        x,
        y,
        h_edges_,
        rows,
        order,
    )
    print(f"pixel_x: {pixel_x}")
    print(f"pixel_y: {pixel_y}")
    print(f"subpixel_x: {subpixel_x}")
    print(f"subpixel_y: {subpixel_y}")
    print(f"nx: {nx}")
    print(f"ny: {ny}")
    print(f"curv: {curv}")
    print(f"i0: {i0}")
    print(f"i1: {i1}")
    print("test_h_edges end\n")

    print("test_v_edges start")
    pixel_x, pixel_y, subpixel_x, subpixel_y, nx, ny, curv, i0, i1 = v_edges(
        image_flatten,
        Gx,
        Gy,
        x,
        y,
        v_edges_,
        rows,
        order,
    )
    print(f"pixel_x: {pixel_x}")
    print(f"pixel_y: {pixel_y}")
    print(f"subpixel_x: {subpixel_x}")
    print(f"subpixel_y: {subpixel_y}")
    print(f"nx: {nx}")
    print(f"ny: {ny}")
    print(f"curv: {curv}")
    print(f"i0: {i0}")
    print(f"i1: {i1}")
    print("test_v_edges end\n")


if __name__ == '__main__':
    test_h_v_edges()
